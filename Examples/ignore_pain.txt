^1^T^SType^Sdynamicbar ^STimerBar_StartColor^Sffea7f20 ^SConditions^T ^N1^T ^SType^SBUFFDUR ^SOperator^S> ^SName^SIgnore~`Pain ^t^Sn^N1 ^t^STimerBar_EnableColors^B ^SEvents^T ^N1^T ^SType^SLua ^SLua^Slocal~`icon~`=~`...~J ~J local~`GetPlayerAuraBySpellID~`=~`C_UnitAuras.GetPlayerAuraBySpellID~J ~J local~`aura_env~`=~`{~J ~`~`~`~`expirationTime~`=~`0~J }~J icon.aura_env~`=~`aura_env~J ~J local~`ip_percent_of_health~`=~`'ip_percent_of_health'~J local~`ip_percent_of_cap~`=~`'ip_percent_of_cap'~J local~`ip_value~`=~`'ip_value'~J local~`ip_duration~`=~`'ip_duration'~J local~`timer_name~`=~`'ip_timer'~J ~J aura_env.names~`=~`{~J ~`~`~`~`pohealth~`=~`ip_percent_of_health,~J ~`~`~`~`pocap~`=~`ip_percent_of_cap,~J ~`~`~`~`value~`=~`ip_value,~J ~`~`~`~`duration~`=~`ip_duration~J }~J aura_env.timer_name~`=~`timer_name~J ~J for~`_,~`name~`in~`ipairs(aura_env.names)~`do~`TMW_ST:InitCounter(name,~`0)~`end~J ~J icon:setMaxValue(100)~J ~J TMW_ST.Timers.Init(timer_name)~J ~J function~`getIPValues(state)~J ~`~`~`~`local~`auraDetails~`=~`GetPlayerAuraBySpellID(190456)~J ~`~`~`~`if~`not~`auraDetails~`then~`return~`false~`end~J ~`~`~`~`~J ~`~`~`~`local~`currentAbsorb~`=~`auraDetails.points[1]~`or~`0~J ~`~`~`~`local~`health~`=~`~`UnitHealthMax("player")~`~J ~`~`~`~`~J ~`~`~`~`local~`absorbCap~`=~`health~`*~`0.3~J ~`~`~`~`~J ~`~`~`~`local~`values=~`{~J ~`~`~`~`~`~`~`~`percentOfCap~`=~`currentAbsorb~`/~`absorbCap~`*~`100,~J ~`~`~`~`~`~`~`~`percentOfMaxHp~`=~`currentAbsorb~`/~`health~`*~`100,~J ~`~`~`~`~`~`~`~`value~`=~`currentAbsorb,~J ~`~`~`~`~`~`~`~`expirationTime~`=~`auraDetails.expirationTime,~J ~`~`~`~`~`~`~`~`duration~`=~`auraDetails.duration~`or~`0~J ~`~`~`~`}~J ~`~`~`~`~J ~`~`~`~`return~`values~J end~J ~J --~`[(Counter("ip_value")/1000):Round(1)]k~`/~`[Counter("ip_percent_of_cap"):Round]%~J --~`[(Counter("ip_duration")~`-~`Timer('ip_timer')):Hide(0):Round(1)]~J ~J function~`handleEvent(event,~`...)~J ~`~`~`~`local~`values~`=~`getIPValues(state)~J ~`~`~`~`~J ~`~`~`~`if~`not~`values~`then~`return~`end~J ~`~`~`~`~J ~`~`~`~`if~`(values.expirationTime~`~|=~`aura_env.expirationTime)~`then~J ~`~`~`~`~`~`~`~`aura_env.expirationTime~`=~`values.expirationTime~J ~`~`~`~`~`~`~`~`~J ~`~`~`~`~`~`~`~`TMW_ST:UpdateCounter(aura_env.names.duration,~`values.expirationTime~`-~`TMW.time)~J ~`~`~`~`~`~`~`~`TMW_ST.Timers.Reset(timer_name)~J ~`~`~`~`~`~`~`~`TMW_ST.Timers.Start(timer_name)~J ~`~`~`~`end~J ~`~`~`~`~J ~`~`~`~`icon:setCurrentValue(values.percentOfCap)~J ~`~`~`~`~J ~`~`~`~`TMW_ST:UpdateCounter(aura_env.names.pohealth,~`values.percentOfMaxHp)~J ~`~`~`~`TMW_ST:UpdateCounter(aura_env.names.pocap,~`values.percentOfCap)~J ~`~`~`~`TMW_ST:UpdateCounter(aura_env.names.value,~`values.value)~J end~J ~J local~`events~`=~`{'UNIT_AURA'}~J ~J for~`_,~`event~`in~`ipairs(events)~`do~J ~`~`~`~`TMW_ST:RegisterEvent(event,~`handleEvent)~J end~J ~J function~`printTable(t)~J ~`~`~`~`for~`key,value~`in~`ipairs(t)~`do~`print(key,~`value)~`end~J end ^SEvent^SOnEventsRestored ^t^N2^T ^SType^SLua ^SLua^S--~`<reset~`counters>~J ~J local~`icon~`=~`...~J ~J local~`aura_env~`=~`icon.aura_env~J for~`_,name~`in~`ipairs(aura_env.names)~`do~J ~`~`~`~`TMW_ST:UpdateCounter(name,0)~J end~J ~J TMW_ST.Timers.Reset(aura_env.timer_name)~J TMW_ST.Timers.Stop(aura_env.timer_name) ^SEvent^SOnHide ^t^Sn^N2 ^t^SSettingsPerView^T ^Sbar^T ^STexts^T ^N1^S[(Counter("ip_value")~`/~`1000):Round(1)]k~`/~`[Counter("ip_percent_of_cap"):Round]% ^N2^S[(Counter("ip_duration")~`-~`Timer('ip_timer')):Hide(0):Round(1)] ^t^t^t^SCustomTex^S190456 ^STimerBar_MiddleColor^Sffea7f20 ^STimerBar_CompleteColor^Sffea7f20 ^SEnabled^B ^t^N100200^S~`~| ^Sicon^^