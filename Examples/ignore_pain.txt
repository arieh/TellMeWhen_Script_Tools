^1^T^SType^Sdynamicbar ^STimerBar_StartColor^Sffea7f20 ^SConditions^T ^N1^T ^SType^SBUFFDUR ^SOperator^S> ^SName^SIgnore~`Pain ^t^Sn^N1 ^t^STimerBar_EnableColors^B ^SEvents^T ^N1^T ^SType^SLua ^SLua^Slocal~`icon~`=~`...~J ~J local~`GetPlayerAuraBySpellID~`=~`C_UnitAuras.GetPlayerAuraBySpellID~J ~J local~`aura_env~`=~`{~J ~`~`~`~`expirationTime~`=~`0~J }~J icon.aura_env~`=~`aura_env~J ~J local~`ip_duration~`=~`'ip_duration'~J local~`ip_percent_of_health~`=~`'ip_percent_of_health'~J local~`timer_name~`=~`'ip_timer'~J ~J aura_env.names~`=~`{~J ~`~`~`~`pohealth~`=~`ip_percent_of_health,~J ~`~`~`~`duration~`=~`ip_duration~J }~J aura_env.timer_name~`=~`timer_name~J ~J for~`_,~`name~`in~`ipairs(aura_env.names)~`do~`TMW_ST:InitCounter(name,~`0)~`end~J ~J icon:setMaxValue(UnitHealthMax('player')~`*~`0.3)~J ~J TMW_ST.Timers.Init(timer_name)~J ~J function~`getIPValues(state)~J ~`~`~`~`local~`auraDetails~`=~`GetPlayerAuraBySpellID(190456)~J ~`~`~`~`if~`not~`auraDetails~`then~`return~`nil~`end~J ~`~`~`~`~J ~`~`~`~`local~`currentAbsorb~`=~`auraDetails.points[1]~`or~`0~J ~`~`~`~`local~`health~`=~`~`UnitHealthMax("player")~`~J ~`~`~`~`~J ~`~`~`~`local~`absorbCap~`=~`health~`*~`0.3~J ~`~`~`~`~J ~`~`~`~`local~`values=~`{~J ~`~`~`~`~`~`~`~`cap~`=~`absorbCap,~J ~`~`~`~`~`~`~`~`value~`=~`currentAbsorb,~J ~`~`~`~`~`~`~`~`expirationTime~`=~`auraDetails.expirationTime,~J ~`~`~`~`~`~`~`~`duration~`=~`auraDetails.duration~`or~`0~J ~`~`~`~`}~J ~`~`~`~`~J ~`~`~`~`return~`values~J end~J ~J aura_env.update~`=~`function()~J ~`~`~`~`local~`values~`=~`getIPValues()~J ~`~`~`~`~J ~`~`~`~`if~`not~`values~`then~`return~`end~J ~`~`~`~`~J ~`~`~`~`if~`(values.expirationTime~`~|=~`aura_env.expirationTime)~`then~J ~`~`~`~`~`~`~`~`aura_env.expirationTime~`=~`values.expirationTime~J ~`~`~`~`~`~`~`~`~J ~`~`~`~`~`~`~`~`TMW_ST:UpdateCounter(aura_env.names.duration,~`values.expirationTime~`-~`TMW.time)~J ~`~`~`~`~`~`~`~`TMW_ST.Timers.Reset(timer_name)~J ~`~`~`~`~`~`~`~`TMW_ST.Timers.Start(timer_name)~J ~`~`~`~`end~J ~`~`~`~`~J ~`~`~`~`icon:setCurrentValue(values.value)~J ~`~`~`~`icon:setMaxValue(values.cap)~J ~`~`~`~`TMW_ST:UpdateCounter(aura_env.names.pohealth,~`values.percentOfMaxHp)~J ~`~`~`~`~J end~J ~J aura_env.handleEvent~`=~`function(event,~`unit)~J ~`~`~`~`if~`unit~`~|=~`'player'~`then~`return~`end~J ~`~`~`~`aura_env.update()~J end~J ~J ~J  ^SEvent^SOnEventsRestored ^t^N2^T ^SType^SLua ^SLua^S~J local~`icon~`=~`...~J ~J local~`aura_env~`=~`icon.aura_env~J for~`_,name~`in~`ipairs(aura_env.names)~`do~J ~`~`~`~`TMW_ST:UpdateCounter(name,0)~J end~J ~J TMW_ST.Timers.Reset(aura_env.timer_name)~J TMW_ST.Timers.Stop(aura_env.timer_name)~J TMW_ST:RemoveEvent('UNIT_AURA',~`aura_env.handleEvent)~J ~J ~J ~J ~J ~J ~J ~J  ^SEvent^SOnHide ^t^N3^T ^SType^SLua ^SLua^S--~`<Untitled~`Lua~`Code>~J ~J local~`icon~`=~`...~J ~J --Your~`code~`goes~`here:~J ~J icon.aura_env.update()~J TMW_ST:AddEvent('UNIT_AURA',~`icon.aura_env.handleEvent)~J ~`~`~`~`~J ~`~`~`~`~J ~`~`~`~`~J ~`~`~`~`~J ~`~`~`~`~J ~`~`~`~`~J ~J  ^SEvent^SOnShow ^t^Sn^N3 ^t^SSettingsPerView^T ^Sbar^T ^STexts^T ^N1^S[Value:Short]~`/~`[(Value~`/~`ValueMax~`*~`100):Round:Percent] ^N2^S[(Counter("ip_duration")~`-~`Timer('ip_timer')):Hide(0):Round(1)] ^t^t^t^SCustomTex^SNONE ^STimerBar_MiddleColor^Sffea7f20 ^STimerBar_CompleteColor^Sffea7f20 ^SEnabled^B ^t^N100200^S~`~| ^Sicon^^
